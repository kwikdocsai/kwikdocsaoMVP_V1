import{u as V,a as z,r as d,R as G,B as O,F as H,Z as f,S as Y,j as e,b as Z,c as J,D as i,L as Q}from"./index-BvHaD_sX.js";import{L as X}from"./layout-dashboard-PVh2xoic.js";import{U as q}from"./users-DMHho2p9.js";import{S as K}from"./sparkles-BZgMBraH.js";import{S as ee}from"./scan-line-04XmWw6T.js";import{C as te}from"./chart-column-DupcTc2y.js";import{T as se}from"./triangle-alert-DZRd9F7q.js";import{S as b}from"./shield-check-PqfTO4CK.js";import{W as ae}from"./wallet-DEqgNa5M.js";import{X as k}from"./x-Q87IfRaK.js";import{C as le}from"./chevron-right-DQHu5Kzy.js";import{C as re}from"./chevron-left-erhv2y9N.js";import{R as ie}from"./refresh-cw-VoQrf2Ak.js";import{I as oe}from"./inbox-BAuY2Dgk.js";import{E as ne}from"./eye-CnOffezs.js";import{C as ce}from"./circle-alert-CUNnj_qJ.js";const Ee=({currentView:x,onChangeView:o})=>{const{user:s,logout:I}=V(),{lastBatchIds:de,notifications:m,markNotificationRead:g,deleteNotification:T,selectedCompany:N,uploadQueue:w,refreshData:_,setIsTopupWizardOpen:L,setSelectedDocument:xe}=z(),[a,D]=d.useState(!1),[h,j]=d.useState(!1),[v,C]=d.useState(!1),[n,y]=d.useState(null);G.useEffect(()=>{const t=l=>{l.preventDefault(),y(l)};return window.addEventListener("beforeinstallprompt",t),()=>window.removeEventListener("beforeinstallprompt",t)},[]);const P=async()=>{if(!n)return;n.prompt();const{outcome:t}=await n.userChoice;t==="accepted"&&y(null)},U=async t=>{t.stopPropagation(),C(!0);try{await _()}finally{setTimeout(()=>C(!1),1e3)}},R=m.filter(t=>!t.read).length,p=t=>x===t||x==="ANALYSIS_RESULTS"&&t==="UPLOAD",B=t=>`
        flex items-center w-full ${a?"justify-center px-2":"px-5"} py-3.5 mb-2 text-sm font-medium transition-all rounded-2xl group relative
        ${p(t)?"bg-[#151515] text-white shadow-[0_0_20px_rgba(20,184,166,0.1)]":"text-slate-500 hover:text-slate-200 hover:bg-[#111]"}
    `;(s==null?void 0:s.role)==="OPERATOR"||(s==null||s.role);const S=(s==null?void 0:s.role)==="COLLABORATOR",$=[{id:"OVERVIEW",label:"Visão Geral",icon:X},{id:"NIFS",label:"Entidades (NIF)",icon:O},{id:"CLIENTS",label:"Empresas",icon:q,adminOnly:!0},{id:"AI_ASSISTANT",label:"Assistente IA",icon:K},{id:"UPLOAD",label:"Analisar",icon:ee},{id:"DOCUMENTS",label:"Documentos",icon:H},{id:"REPORTS",label:"Relatórios",icon:te},{id:"FISCAL_ERRORS",label:"Erros Fiscais",icon:se},{id:"COMPLIANCE",label:"Conformidade AGT",icon:b,hasBadge:!0},{id:"PERFORMANCE_SERVERS",label:"Servidores Performance",icon:f},{id:"CREDITS",label:"Créditos",icon:ae,adminOnly:!0},{id:"SETTINGS",label:"Configurações",icon:Y,adminOnly:!0},{id:"SAAS_ADMIN",label:"Backoffice",icon:b,superAdminOnly:!0}].filter(t=>t.superAdminOnly?(s==null?void 0:s.role)==="SUPER_ADMIN":(s==null?void 0:s.role)==="COLLABORATOR"?["OVERVIEW","UPLOAD"].includes(t.id):(s==null?void 0:s.role)==="ACCOUNTANT"?!0:(s==null?void 0:s.role)==="OPERATOR"?!t.adminOnly:!0),F=t=>{t.stopPropagation(),j(!h)},M=t=>{g(t.id),t.actionType==="VIEW_BATCH"&&(o("ANALYSIS_RESULTS"),j(!1))},c=N!=="ALL"?N:null;return e.jsxs("div",{className:`flex flex-col h-full ${a?"w-24":"w-72"} bg-[#050505] border-r border-white/[0.03] relative transition-all duration-300 ease-in-out`,children:[e.jsxs("div",{className:`flex items-center ${a?"justify-center":"justify-between px-6"} h-28 transition-all relative overflow-hidden`,children:[e.jsx(Z,{className:`${a?"w-12 h-12":"w-48 h-16"} transition-all duration-300`,iconClassName:"w-full h-full"}),!a&&e.jsx("button",{onClick:()=>o(x),className:"lg:hidden p-2 text-slate-500 hover:text-white transition-colors",title:"Fechar Menu",children:e.jsx(k,{className:"w-6 h-6"})})]}),e.jsx("button",{onClick:()=>D(!a),className:"absolute -right-3 top-10 bg-[#151515] border border-white/10 text-slate-400 hover:text-white rounded-full p-1.5 shadow-xl z-50 transition-colors",children:a?e.jsx(le,{className:"w-3 h-3"}):e.jsx(re,{className:"w-3 h-3"})}),e.jsxs("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto custom-scrollbar overflow-x-hidden",children:[!a&&e.jsxs("div",{className:"px-5 mb-4 mt-2 text-[10px] font-bold text-slate-600 uppercase tracking-widest flex items-center justify-between",children:[e.jsx("span",{children:"Hub Central"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:U,className:`p-1.5 rounded-lg text-slate-500 hover:text-white hover:bg-white/5 transition-all ${v?"text-teal-400":""}`,title:"Sincronizar Dados",children:e.jsx(ie,{className:`w-4 h-4 ${v?"animate-spin":"active:rotate-180 transition-transform duration-500"}`})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:F,className:`relative p-1.5 rounded-lg transition-colors ${h?"bg-white/10 text-white":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:[e.jsx(J,{className:"w-4 h-4"}),R>0&&e.jsx("span",{className:"absolute top-0.5 right-0.5 w-2 h-2 bg-red-500 rounded-full shadow-[0_0_5px_#ef4444] animate-pulse"})]}),h&&e.jsxs("div",{className:"fixed left-[80px] top-20 w-80 bg-[#0c0c0c] border border-white/10 rounded-2xl shadow-2xl z-[9999] animate-in slide-in-from-left-4 fade-in overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-white/5 flex justify-between items-center bg-[#111]",children:[e.jsx("h3",{className:"text-xs font-bold text-white uppercase tracking-wider",children:"Notificações"}),R>0&&e.jsx("button",{onClick:()=>g(),className:"text-[10px] text-cyan-400 hover:text-white transition-colors",children:"Marcar lidas"})]}),e.jsx("div",{className:"max-h-[300px] overflow-y-auto custom-scrollbar",children:m.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-500",children:[e.jsx(oe,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-xs",children:"Sem notificações recentes."})]}):m.map(t=>e.jsxs("div",{className:`p-4 border-b border-white/5 transition-colors relative group ${t.read?"bg-[#0c0c0c] opacity-70 hover:opacity-100":"bg-white/[0.03] hover:bg-white/[0.05]"}`,children:[!t.read&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-cyan-500"}),e.jsx("button",{onClick:()=>T(t.id),className:"absolute top-2 right-2 p-1 text-slate-600 hover:text-white opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(k,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:`mt-1 w-2 h-2 rounded-full flex-shrink-0 ${t.type==="error"?"bg-red-500":"bg-emerald-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"text-xs font-bold text-white mb-1 pr-4",children:t.title}),e.jsx("span",{className:"text-[9px] text-slate-600 font-mono",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("p",{className:"text-[11px] text-slate-400 leading-snug",children:t.message}),t.actionType==="VIEW_BATCH"&&e.jsxs("button",{onClick:()=>M(t),className:"mt-3 w-full py-2 bg-cyan-500 hover:bg-cyan-400 text-black text-[10px] font-bold uppercase tracking-wide rounded-lg flex items-center justify-center gap-2 transition-colors shadow-lg shadow-cyan-500/20 group-hover:scale-[1.02]",children:[e.jsx(ne,{className:"w-3 h-3"})," Ver Resultados"]})]})]})]},t.id))})]})]})]})]}),$.map(t=>{const l=t.id==="UPLOAD",A=w.filter(r=>r.status===i.PROCESSING).length,W=w.filter(r=>r.status===i.COMPLETED||r.status===i.ERROR||r.status===i.REJEITADO||r.status===i.APROVADO||r.status===i.PENDING_REVIEW).length,u=A>0,E=!u&&W>0;return e.jsxs("button",{onClick:()=>o(t.id),className:B(t.id),title:a?t.label:void 0,children:[p(t.id)&&e.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 bg-teal-500 rounded-r-full shadow-[0_0_10px_#14b8a6]"}),e.jsxs("div",{className:"relative",children:[e.jsx(t.icon,{className:`w-5 h-5 flex-shrink-0 transition-colors ${p(t.id)?"text-teal-400":"text-slate-600 group-hover:text-slate-300"} ${a?"":"mr-3"}`}),l&&u&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-cyan-500 rounded-full border-2 border-[#050505] animate-pulse shadow-[0_0_8px_rgba(6,182,212,0.5)]"}),l&&E&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-emerald-500 rounded-full border-2 border-[#050505] shadow-[0_0_8px_rgba(16,185,129,0.5)]"})]}),!a&&e.jsx("span",{className:"truncate",children:t.label}),!a&&t.hasBadge&&e.jsx("span",{className:"ml-auto text-[8px] bg-emerald-500/20 text-emerald-400 px-1.5 py-0.5 rounded font-black tracking-tighter uppercase",children:"Novo"}),!a&&l&&u&&e.jsx("span",{className:"ml-auto text-[9px] font-bold text-cyan-400 animate-pulse bg-cyan-500/10 px-2 py-0.5 rounded-full",children:"Processando"}),!a&&l&&E&&e.jsx("span",{className:"ml-auto text-[9px] font-bold text-emerald-400 bg-emerald-500/10 px-2 py-0.5 rounded-full",children:"Concluído"})]},t.id)})]}),e.jsxs("div",{className:"p-4 border-t border-white/[0.03] bg-[#050505] flex flex-col gap-4",children:[!a&&n&&e.jsxs("button",{onClick:P,className:"flex items-center justify-center gap-2 p-3 bg-gradient-to-r from-teal-500 to-emerald-500 text-black font-bold text-xs uppercase tracking-wide rounded-xl hover:from-teal-400 hover:to-emerald-400 transition-all shadow-lg shadow-teal-500/20 hover:scale-[1.02]",children:[e.jsx(f,{className:"w-4 h-4 fill-current"})," Baixar App"]}),!a&&c&&!S&&e.jsxs("div",{className:"bg-gradient-to-br from-teal-500/10 to-cyan-900/20 rounded-xl p-4 border border-teal-500/20 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"text-[10px] font-bold text-teal-400 uppercase tracking-wider flex items-center gap-1.5",children:[e.jsx(O,{className:"w-3 h-3"})," Empresa"]}),e.jsx("button",{onClick:()=>o("CREDITS"),className:"text-[9px] bg-black/40 text-slate-300 px-2 py-0.5 rounded hover:text-white transition-colors",children:"Recarregar"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-2xl font-black text-white",children:c.credits}),e.jsx("span",{className:"text-[10px] font-medium text-slate-500",children:"créditos disp."})]})]}),!a&&s&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-indigo-900/20 rounded-xl p-4 border border-purple-500/20 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"text-[10px] font-bold text-purple-400 uppercase tracking-wider flex items-center gap-1.5",children:[e.jsx(f,{className:"w-3 h-3 fill-current"})," Carteira Pessoal"]}),!S&&e.jsx("button",{onClick:()=>{o("CREDITS"),L(!0)},className:"text-[9px] bg-black/40 text-slate-300 px-2 py-0.5 rounded hover:text-white transition-colors",children:"Recarregar"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-2xl font-black text-white",children:s.credits||0}),e.jsx("span",{className:"text-[10px] font-medium text-slate-500",children:"créditos seus"})]})]}),e.jsxs("div",{className:`flex items-center ${a?"justify-center":"gap-4"} group cursor-pointer`,children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#151515] border border-white/5 flex items-center justify-center text-white font-bold text-sm overflow-hidden flex-shrink-0 group-hover:border-teal-500/30 transition-colors",children:s!=null&&s.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:s.name,className:"w-full h-full object-cover"}):s==null?void 0:s.name.substring(0,2).toUpperCase()}),!a&&e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("p",{className:"text-sm font-bold text-white truncate",children:(s==null?void 0:s.name)||"Utilizador"}),c&&(c.isVerified?e.jsx(b,{className:"w-3.5 h-3.5 text-cyan-400 drop-shadow-[0_0_5px_rgba(34,211,238,0.5)] flex-shrink-0"}):e.jsx(ce,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0"}))]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-teal-500 shadow-[0_0_5px_#14b8a6]"}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-wider font-bold",children:"Conectado"})]})]}),!a&&e.jsx("button",{onClick:I,title:"Sair",className:"p-2 hover:bg-white/5 rounded-lg text-slate-600 hover:text-white transition-colors",children:e.jsx(Q,{className:"w-4 h-4"})})]})]})]})};export{Ee as default};
