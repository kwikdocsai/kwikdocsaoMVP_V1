import{d as M,u as G,r as i,s as w,j as e,g as q,i as J,Z as Q,B,a as D,P as ee}from"./index-Mr9-xbz5.js";import{G as se}from"./globe-CM8P_Y7G.js";import{T as Y}from"./triangle-alert-C8lI9MhY.js";import{A as te,m as V}from"./proxy-xk3InwfC.js";import{X as Z}from"./x-LcKueY7J.js";import{C as z}from"./check-CzhsT6Tw.js";import{C as I}from"./circle-alert-Cm-2_77F.js";import{R as U}from"./refresh-cw-C3jm_ew_.js";import{F as ae}from"./file-exclamation-point-CcrkcjyX.js";import{W as re}from"./wallet-DQw1BPYL.js";import{T}from"./trash-2-bDERfQQJ.js";import le from"./ToastNotification-Btaq28qO.js";import{S as $}from"./shield-check-S2Ug2A3z.js";import{A as oe}from"./arrow-up-right-J0gDI5TZ.js";import"./circle-check-C04Ed1fF.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],ne=M("layout-grid",ie);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],ce=M("layout-template",de);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],me=M("list",xe);function he({onScanSuccess:t,initialNif:r}){const{user:a}=G(),[o,l]=i.useState(r||""),[c,h]=i.useState(!1),[p,f]=i.useState(null);i.useEffect(()=>{r&&r.length>=9&&m(r)},[r]);const m=async x=>{const u=x||o;if(!u||u.length<9){f("NIF inválido. Insira pelo menos 9 dígitos.");return}h(!0),f(null);try{const b=await w.validateNif(u,(a==null?void 0:a.id)||"unknown");if(!b||!b.nome)throw new Error("NIF não encontrado ou sem dados.");t(b)}catch(b){console.error(b),f(b.message||"Erro ao validar NIF. Tente novamente.")}finally{h(!1)}};return e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-cyan-500/20 blur-xl rounded-full"}),e.jsx("div",{className:"relative w-20 h-20 bg-[#111] border border-cyan-500/30 rounded-full flex items-center justify-center shadow-[0_0_30px_rgba(6,182,212,0.15)]",children:e.jsx(se,{className:"w-10 h-10 text-cyan-400 animate-pulse"})})]}),e.jsxs("div",{className:"text-center space-y-2 max-w-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Sincronização Fiscal"}),e.jsx("p",{className:"text-sm text-gray-400",children:r?"Validando NIF automaticamente...":"Conectando à base de dados da AGT em tempo real."})]}),e.jsxs("div",{className:"w-full max-w-xs space-y-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",value:o,onChange:x=>l(x.target.value.replace(/[^0-9]/g,"")),onKeyDown:x=>x.key==="Enter"&&m(),placeholder:"Digite o NIF (ex: 500...)",className:"w-full bg-[#151515] border border-white/10 rounded-xl px-5 py-4 text-center text-lg font-mono tracking-widest text-white focus:border-cyan-500/50 focus:outline-none transition-all Group-hover:border-white/20",autoFocus:!r}),e.jsx(q,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-600 group-focus-within:text-cyan-500 transition-colors"})]}),p&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-red-400 bg-red-500/10 p-3 rounded-lg border border-red-500/20 justify-center",children:[e.jsx(Y,{className:"w-3 h-3"}),p]}),e.jsx("button",{onClick:()=>m(),disabled:c||!o,className:"w-full py-4 bg-cyan-600 hover:bg-cyan-500 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg shadow-cyan-900/20",children:c?e.jsx(J,{className:"w-5 h-5 animate-spin"}):"Buscar Dados"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-600 uppercase tracking-widest font-medium",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"Serviço Online"]})]})}const pe=({setMode:t,setStep:r})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 h-full",children:[e.jsxs("button",{onClick:()=>{t("AUTO"),r("SCAN")},className:"group relative flex flex-col items-center justify-center p-8 rounded-2xl border border-white/5 bg-[#09090b] hover:bg-white/5 transition-all duration-300 hover:border-emerald-500/30 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 opacity-0 group-hover:opacity-100 transition-opacity blur-2xl"}),e.jsx("div",{className:"relative p-4 rounded-full bg-emerald-500/10 mb-4 group-hover:scale-110 transition-transform shadow-[0_0_15px_rgba(16,185,129,0.2)]",children:e.jsx(Q,{className:"w-8 h-8 text-emerald-500"})}),e.jsx("h3",{className:"relative text-lg font-bold text-white mb-2 tracking-tight",children:"Sincronização AGT"}),e.jsx("p",{className:"relative text-sm text-gray-400 text-center max-w-[200px] leading-relaxed",children:"Validação automática via NIF com dados oficiais."}),e.jsx("div",{className:"relative mt-4 px-3 py-1 rounded-full bg-emerald-500/10 border border-emerald-500/20 text-[10px] font-bold uppercase tracking-wider text-emerald-400",children:"Recomendado"})]}),e.jsxs("button",{onClick:()=>{t("MANUAL"),r("FORM")},className:"group relative flex flex-col items-center justify-center p-8 rounded-2xl border border-white/5 bg-[#09090b] hover:bg-white/5 transition-all duration-300 hover:border-blue-500/30 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition-opacity blur-2xl"}),e.jsx("div",{className:"relative p-4 rounded-full bg-blue-500/10 mb-4 group-hover:scale-110 transition-transform shadow-[0_0_15px_rgba(59,130,246,0.2)]",children:e.jsx(ce,{className:"w-8 h-8 text-blue-500"})}),e.jsx("h3",{className:"relative text-lg font-bold text-white mb-2 tracking-tight",children:"Registro Manual"}),e.jsx("p",{className:"relative text-sm text-gray-400 text-center max-w-[200px] leading-relaxed",children:"Entrada manual de dados. Requer validação posterior."})]})]}),ue=({formData:t,setFormData:r,handleManualSubmit:a,setMode:o})=>e.jsxs("div",{className:"space-y-5 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 tracking-wider ml-1",children:"Nome da Empresa"}),e.jsx("input",{value:t.name,onChange:l=>r({...t,name:l.target.value}),className:"w-full bg-[#0c0c0e] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-blue-500/50 focus:ring-1 focus:ring-blue-500/20 outline-none transition-all",placeholder:"Ex: KwikDocs Lda"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 tracking-wider ml-1",children:"NIF"}),e.jsx("input",{value:t.nif,onChange:l=>r({...t,nif:l.target.value}),className:"w-full bg-[#0c0c0e] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-blue-500/50 focus:ring-1 focus:ring-blue-500/20 outline-none transition-all font-mono",placeholder:"Ex: 500123456"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 tracking-wider ml-1",children:"Email"}),e.jsx("input",{value:t.email,onChange:l=>r({...t,email:l.target.value}),className:"w-full bg-[#0c0c0e] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-blue-500/50 focus:ring-1 focus:ring-blue-500/20 outline-none transition-all",placeholder:"contato@empresa.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 tracking-wider ml-1",children:"Telefone"}),e.jsx("input",{value:t.phone,onChange:l=>r({...t,phone:l.target.value}),className:"w-full bg-[#0c0c0e] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-blue-500/50 focus:ring-1 focus:ring-blue-500/20 outline-none transition-all",placeholder:"+244 900 000 000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-gray-500 tracking-wider ml-1",children:"Morada"}),e.jsx("textarea",{value:t.address,onChange:l=>r({...t,address:l.target.value}),className:"w-full bg-[#0c0c0e] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-600 focus:border-blue-500/50 focus:ring-1 focus:ring-blue-500/20 outline-none h-24 resize-none transition-all",placeholder:"Endereço da sede..."})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-white/5",children:[e.jsx("button",{onClick:()=>o("SELECT"),className:"px-4 py-2 text-xs font-bold text-gray-500 hover:text-white transition-colors uppercase tracking-wide",children:"Voltar"}),e.jsx("button",{onClick:a,disabled:!t.name||!t.nif,className:"px-8 py-3 bg-white text-black hover:bg-gray-200 rounded-xl text-xs font-bold uppercase tracking-wide transition-all shadow-lg hover:shadow-xl hover:scale-[1.02] disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed",children:"Continuar"})]})]}),be=({formData:t,mode:r,isValidating:a,userCredits:o,loading:l,finalSave:c})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 space-y-8 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/20 to-blue-500/20 blur-2xl rounded-full"}),e.jsxs("div",{className:"relative w-24 h-24 rounded-2xl bg-[#111] border border-white/10 flex items-center justify-center shadow-2xl",children:[e.jsx(B,{className:"w-10 h-10 text-white"}),r==="AUTO"&&e.jsx("div",{className:"absolute -bottom-2 -right-2 p-2 bg-emerald-500 rounded-xl border-4 border-[#09090b] shadow-lg",children:e.jsx(z,{className:"w-4 h-4 text-black font-bold"})}),r==="MANUAL"&&e.jsx("div",{className:"absolute -bottom-2 -right-2 p-2 bg-amber-500 rounded-xl border-4 border-[#09090b] shadow-lg",children:e.jsx(I,{className:"w-4 h-4 text-black font-bold"})})]})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-white tracking-tight",children:t.name}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[e.jsx("p",{className:"text-gray-400 font-mono tracking-wider bg-white/5 px-3 py-1 rounded-lg border border-white/5",children:t.nif}),t.fiscal_status&&e.jsx("span",{className:`px-2 py-1 rounded-lg text-[10px] uppercase font-bold border ${t.fiscal_status==="Activo"?"bg-emerald-500/10 text-emerald-500 border-emerald-500/20":"bg-red-500/10 text-red-500 border-red-500/20"}`,children:t.fiscal_status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 max-w-sm mx-auto mt-4 px-2",children:[e.jsxs("div",{className:"bg-white/5 p-2 rounded-xl border border-white/5 text-left",children:[e.jsx("p",{className:"text-[9px] text-gray-500 uppercase font-bold",children:"Tipo"}),e.jsx("p",{className:"text-xs text-gray-300 truncate",children:t.company_type||"-"})]}),e.jsxs("div",{className:"bg-white/5 p-2 rounded-xl border border-white/5 text-left",children:[e.jsx("p",{className:"text-[9px] text-gray-500 uppercase font-bold",children:"Regime"}),e.jsx("p",{className:"text-xs text-gray-300 truncate",children:t.tax_regime||"-"})]}),e.jsxs("div",{className:"bg-white/5 p-2 rounded-xl border border-white/5 text-left",children:[e.jsx("p",{className:"text-[9px] text-gray-500 uppercase font-bold",children:"Residência"}),e.jsx("p",{className:"text-xs text-gray-300",children:t.fiscal_residence?"Residente":"Não Residente"})]}),e.jsxs("div",{className:"bg-white/5 p-2 rounded-xl border border-white/5 text-left",children:[e.jsx("p",{className:"text-[9px] text-gray-500 uppercase font-bold",children:"Inadimplente"}),e.jsx("p",{className:`text-xs font-bold ${t.is_defaulter?"text-red-500":"text-emerald-500"}`,children:t.is_defaulter?"SIM":"NÃO"})]})]})]}),a&&e.jsxs("div",{className:"px-6 py-3 rounded-xl bg-blue-500/10 border border-blue-500/20 text-blue-400 text-xs font-bold uppercase tracking-wide flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 animate-spin-slow"})," Validando Empresa Pendente"]}),e.jsxs("div",{className:"w-full max-w-sm space-y-4 pt-4",children:[r==="MANUAL"&&!a&&e.jsxs("div",{className:"p-3 rounded-xl bg-amber-500/10 border border-amber-500/20 text-xs text-amber-200 text-center font-medium",children:["Atenção: O status será ",e.jsx("b",{children:"PENDENTE"})," até a validação do NIF."]}),e.jsxs("button",{onClick:c,disabled:l,className:"w-full py-4 bg-white text-black rounded-xl font-bold text-sm hover:bg-gray-200 transition-all shadow-[0_0_20px_rgba(255,255,255,0.1)] hover:shadow-[0_0_30px_rgba(255,255,255,0.2)] hover:scale-[1.01] disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[l?e.jsx(U,{className:"w-5 h-5 animate-spin"}):e.jsx(z,{className:"w-5 h-5"}),a?"CONFIRMAR VALIDAÇÃO":"CONFIRMAR CRIAÇÃO"]})]})]}),fe=({onClose:t,onSave:r,initialData:a})=>{const{user:o}=G(),[l,c]=i.useState("SELECT"),[h,p]=i.useState("SCAN"),[f,m]=i.useState(!1),x=!!(a&&!a.isVerified),[u,b]=i.useState({name:"",nif:"",email:"",phone:"",address:"",company_type:"",fiscal_status:"",is_defaulter:!1,tax_regime:"",fiscal_residence:!0});i.useEffect(()=>{a&&(b({name:a.name||"",nif:a.nif||"",email:a.email||"",phone:a.phone||"",address:a.address||"",company_type:"",fiscal_status:a.fiscal_status||"",is_defaulter:a.is_defaulter||!1,tax_regime:a.regime||"",fiscal_residence:a.fiscal_residence||!0}),a.isVerified?(c("MANUAL"),p("FORM")):(c("AUTO"),p("SCAN")))},[a]);const N=n=>{b({name:n.nome,nif:n.nif,email:n.email||u.email||"",phone:n.telefone||u.phone||"",address:n.endereco_completo||u.address||"",company_type:n.tipo,fiscal_status:n.estado,is_defaulter:n.inadimplente||!1,tax_regime:n.regime_iva,fiscal_residence:n.residente_fiscal||!0}),p("CONFIRM")},v=()=>{p("CONFIRM")},S=async()=>{m(!0);try{await r({...u,verificationSource:l==="AUTO"?"AGT_SYNC":"MANUAL_ENTRY",isVerified:l==="AUTO"||x}),t()}catch(n){console.error(n)}finally{m(!1)}},y=(o==null?void 0:o.credits)||0;return e.jsx(te,{children:e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),e.jsxs(V.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"relative w-full max-w-2xl bg-[#09090b] border border-white/10 rounded-[24px] shadow-[0_20px_60px_-15px_rgba(0,0,0,0.5)] overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-emerald-500 via-blue-500 to-purple-500 opacity-50"}),e.jsxs("div",{className:"flex items-center justify-between px-8 py-6 border-b border-white/5 bg-white/[0.02]",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3 uppercase tracking-tight",children:[x?"Validar Empresa":a?"Editar Empresa":"Nova Empresa",l==="AUTO"&&e.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] bg-emerald-500/10 text-emerald-500 border border-emerald-500/20 shadow-[0_0_10px_rgba(16,185,129,0.2)]",children:"AGT・SYNC"}),l==="MANUAL"&&e.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] bg-blue-500/10 text-blue-500 border border-blue-500/20",children:"MANUAL"})]}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[h==="SCAN"&&"Digitalize ou insira o NIF para buscar dados oficiais.",h==="FORM"&&"Preencha os dados da empresa manualmente.",h==="CONFIRM"&&"Confirme as transações e finalize o registro."]})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-xl text-gray-500 hover:bg-white/5 hover:text-white transition-all hover:rotate-90 duration-300",children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar",children:[l==="SELECT"&&e.jsx(pe,{setMode:c,setStep:p}),l==="AUTO"&&h==="SCAN"&&e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsx(he,{onScanSuccess:N,initialNif:x?u.nif:void 0}),e.jsx("div",{className:"flex justify-center border-t border-white/5 pt-6",children:e.jsx("button",{onClick:()=>c("SELECT"),className:"text-xs font-bold text-gray-500 hover:text-white uppercase tracking-widest transition-colors",children:"Voltar para seleção"})})]}),l==="MANUAL"&&h==="FORM"&&e.jsx(ue,{formData:u,setFormData:b,handleManualSubmit:v,setMode:c}),h==="CONFIRM"&&e.jsx(be,{formData:u,mode:l,isValidating:x,userCredits:y,loading:f,finalSave:S})]})]})]})})},ge=({isOpen:t,onClose:r,onConfirm:a,company:o,docCount:l})=>{const[c,h]=i.useState(""),[p,f]=i.useState(!1);if(!t||!o)return null;const m=c===o.name,x=o.credits||0,u=async()=>{if(m){f(!0);try{await a(),r()}finally{f(!1),h("")}}};return e.jsxs("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md",onClick:r}),e.jsxs("div",{className:"relative w-full max-w-md bg-[#0f111a] border border-red-500/20 rounded-2xl shadow-[0_0_50px_rgba(239,68,68,0.2)] flex flex-col animate-in fade-in zoom-in-95 duration-300 overflow-hidden",children:[e.jsxs("div",{className:"p-6 bg-red-500/5 border-b border-red-500/10 flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-red-500/10 rounded-full text-red-500 border border-red-500/20 flex-shrink-0",children:e.jsx(Y,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Zona de Perigo"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Você está prestes a remover permanentemente a empresa ",e.jsxs("span",{className:"text-white font-bold",children:['"',o.name,'"']}),"."]})]}),e.jsx("button",{onClick:r,className:"ml-auto text-slate-500 hover:text-white",children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-red-500/5 border border-red-500/10 rounded-xl p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-red-400 uppercase",children:[e.jsx(ae,{className:"w-4 h-4"})," Impacto da Ação"]}),e.jsxs("ul",{className:"text-sm text-slate-300 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"O acesso de todos os utilizadores será revogado."}),e.jsxs("li",{children:[e.jsxs("span",{className:"font-bold text-white",children:[l," documentos"]})," fiscais serão arquivados/removidos."]}),e.jsx("li",{children:"Tudo relacionado a esta empresa sera apagado."})]})]}),x>0&&e.jsxs("div",{className:"bg-emerald-500/5 border border-emerald-500/10 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-emerald-500/10 rounded-full text-emerald-400",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-emerald-400 uppercase",children:"Reembolso Automático"}),e.jsxs("p",{className:"text-sm text-slate-300",children:[e.jsxs("span",{className:"text-white font-bold",children:[x," créditos"]})," serão retornados à conta principal."]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300",children:["Para confirmar, digite ",e.jsx("span",{className:"select-all font-mono font-bold text-white bg-white/10 px-1 rounded",children:o.name})," abaixo:"]}),e.jsx("input",{type:"text",value:c,onChange:b=>h(b.target.value),placeholder:o.name,className:"w-full bg-[#05060a] border border-red-500/30 focus:border-red-500 rounded-xl px-4 py-3 text-white placeholder-slate-700 focus:outline-none focus:ring-1 focus:ring-red-500/50 transition-all font-medium"})]})]}),e.jsxs("div",{className:"p-4 bg-[#05060a] border-t border-white/5 flex justify-end gap-3",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 font-medium transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:u,disabled:!m||p,className:"px-4 py-2 rounded-xl bg-red-500 text-white font-bold hover:bg-red-600 transition-all shadow-[0_0_20px_rgba(239,68,68,0.2)] disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:p?"Processando...":e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4"})," Deletar Empresa"]})})]})]})]})},Ne={STARTER:50,PRO:200,BUSINESS:600,ENTERPRISE:1e3},Pe=({onSelectClient:t})=>{const{clients:r,refreshData:a}=D(),[o,l]=i.useState(""),[c,h]=i.useState("ALL"),[p,f]=i.useState(!1),[m,x]=i.useState(null),[u,b]=i.useState(null),[N,v]=i.useState("LIST"),[S,y]=i.useState(null),[n,C]=i.useState(null),[K,L]=i.useState(0),R=async s=>{try{const d=await w.getCompanyDocCount(s.id);L(d),C(s)}catch(d){console.error(d),L(0),C(s)}},_=r.filter(s=>{const d=s.name.toLowerCase().includes(o.toLowerCase())||s.nif.includes(o),g=c==="ALL"||s.status===c;return d&&g}),j=(s,d,g)=>{y({id:Date.now().toString(),type:s,title:d,message:g})},W=()=>{x(null),f(!0)},P=s=>{x(s),f(!0)},X=async s=>{try{m?(await w.updateClient(m.id,s),j("success","Empresa Atualizada",`Os dados da ${s.name} foram salvos.`)):(await w.createClient(s),j("success","Empresa Criada",`${s.name} foi adicionada à carteira.`)),await a()}catch(d){j("error","Erro",d.message||"Não foi possível salvar os dados.")}},H=async()=>{if(n)try{await w.deleteClient(n.id),j("success","Empresa Removida",`${n.name} foi removido com sucesso.`),await a()}catch{j("error","Erro","Falha ao remover empresa.")}finally{C(null)}},O=s=>{const d=Ne[s.plan]||100,g=s.credits||0;return{pct:Math.min(g/d*100,100),max:d,current:g}},F=s=>s<20?"bg-red-500":s<50?"bg-amber-500":"bg-emerald-500";return e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500 relative pb-20",children:[e.jsx(le,{toast:S,onClose:()=>y(null)}),p&&e.jsx(fe,{onClose:()=>f(!1),onSave:X,initialData:m},m?m.id:"new"),p&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 pointer-events-none"}),e.jsxs("div",{className:"bg-[#080808] border border-white/[0.03] rounded-[32px] p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[400px] h-[400px] bg-teal-500/5 blur-[100px] rounded-full pointer-events-none -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-end gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-teal-500"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Base de Dados"})]}),e.jsx("h1",{className:"text-4xl font-bold text-white tracking-tighter mb-2",children:"Carteira de Empresas"}),e.jsx("p",{className:"text-slate-400 text-sm max-w-lg",children:"Gestão centralizada de entidades fiscais. Controle de planos, acessos e monitorização de status."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"bg-[#111] p-1 rounded-xl border border-white/5 flex",children:[e.jsx("button",{onClick:()=>v("LIST"),className:`p-2 rounded-lg transition-all ${N==="LIST"?"bg-[#222] text-white":"text-slate-500 hover:text-white"}`,children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>v("GRID"),className:`p-2 rounded-lg transition-all ${N==="GRID"?"bg-[#222] text-white":"text-slate-500 hover:text-white"}`,children:e.jsx(ne,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:W,className:"bg-teal-500 hover:bg-teal-400 text-black px-6 py-3 rounded-xl flex items-center gap-2 font-bold text-sm uppercase tracking-wide transition-all shadow-[0_0_20px_rgba(20,184,166,0.3)] hover:scale-105",children:[e.jsx(ee,{className:"w-4 h-4"})," Adicionar Empresa"]})]})]}),e.jsxs("div",{className:"mt-8 flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx(q,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 w-4 h-4 group-focus-within:text-white transition-colors"}),e.jsx("input",{type:"text",placeholder:"Procurar empresa por nome, NIF ou ID...",value:o,onChange:s=>l(s.target.value),className:"w-full bg-[#111] border border-white/5 rounded-2xl pl-11 pr-4 py-3.5 text-sm text-white placeholder-slate-600 focus:outline-none focus:border-teal-500/50 transition-all font-medium"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("select",{value:c,onChange:s=>h(s.target.value),className:"bg-[#111] border border-white/5 rounded-2xl px-6 py-3.5 text-sm font-bold text-slate-300 focus:outline-none focus:border-teal-500/50 appearance-none cursor-pointer hover:bg-[#161616] transition-colors",children:[e.jsx("option",{value:"ALL",children:"Status: Todos"}),e.jsx("option",{value:"ACTIVE",children:"Status: Ativos"}),e.jsx("option",{value:"SUSPENDED",children:"Status: Suspensos"}),e.jsx("option",{value:"PENDING",children:"Status: Pendentes"})]})})]})]}),_.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-600",children:[e.jsx(B,{className:"w-16 h-16 mb-4 opacity-20"}),e.jsx("h3",{className:"text-white font-bold text-lg mb-1",children:"Base de dados vazia"}),e.jsx("p",{className:"text-sm font-mono",children:"Nenhum resultado para os filtros atuais."})]}):N==="LIST"?e.jsx("div",{className:"space-y-2",children:_.map(s=>{const{pct:d,current:g,max:k}=O(s),A=F(d);return e.jsxs("div",{className:"group bg-[#0c0c0c] border border-white/[0.04] rounded-[24px] p-4 flex items-center justify-between hover:border-white/10 transition-all hover:bg-[#111]",children:[e.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-[#151515] border border-white/5 flex items-center justify-center text-sm font-bold text-white shadow-inner group-hover:border-teal-500/30 transition-colors",children:s.name.substring(0,2).toUpperCase()}),e.jsxs("div",{className:"w-64",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("h3",{className:"text-white font-bold text-lg tracking-tight group-hover:text-teal-400 transition-colors",children:s.name}),s.isVerified?e.jsx($,{className:"w-4 h-4 text-cyan-400 drop-shadow-[0_0_8px_rgba(34,211,238,0.5)]",title:`Verificado via ${s.verificationSource}`}):e.jsxs("button",{onClick:E=>{E.stopPropagation(),P(s)},className:"flex items-center gap-1 group/verify cursor-pointer bg-amber-500/10 px-2 py-0.5 rounded-full border border-amber-500/20",title:"Clique para validar NIF",children:[e.jsx(I,{className:"w-3.5 h-3.5 text-amber-500 group-hover/verify:scale-110 transition-transform"}),e.jsx("span",{className:"text-[10px] font-bold text-amber-500 uppercase",children:"Validar"})]})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-slate-500 font-mono",children:e.jsxs("span",{children:["NIF: ",s.nif]})})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-8 flex-1",children:[e.jsxs("div",{className:"w-32",children:[e.jsxs("div",{className:"flex justify-between items-end mb-1",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest",children:"Créditos"}),e.jsxs("span",{className:"text-[10px] font-mono text-slate-400",children:[g,"/",k]})]}),e.jsx("div",{className:"h-1.5 w-full bg-[#1a1a1a] rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${A} transition-all duration-500`,style:{width:`${d}%`}})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest mb-1",children:"Status"}),e.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-bold ${s.status==="ACTIVE"?"text-emerald-500":s.status==="PENDING"?"text-amber-500":"text-red-500"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${s.status==="ACTIVE"?"bg-emerald-500":s.status==="PENDING"?"bg-amber-500":"bg-red-500"}`}),s.status==="ACTIVE"?"ATIVO":s.status==="PENDING"?"PENDENTE":"SUSPENSO"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pl-6 border-l border-white/5",children:[e.jsx("button",{onClick:()=>t(s.id),title:"Aceder",className:"p-3 rounded-xl bg-[#151515] hover:bg-teal-50 hover:text-black text-teal-500 transition-all",children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>R(s),className:"p-3 rounded-xl hover:bg-[#151515] text-slate-500 hover:text-red-500 transition-colors",children:e.jsx(T,{className:"w-4 h-4"})})]})]},s.id)})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map(s=>{const{pct:d,current:g,max:k}=O(s),A=F(d);return e.jsxs("div",{className:"bg-[#0c0c0c] border border-white/[0.04] rounded-[32px] p-6 hover:border-white/10 transition-all group relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#151515] border border-white/5 flex items-center justify-center text-sm font-bold text-white shadow-inner group-hover:border-teal-500/30 transition-colors",children:s.name.substring(0,2).toUpperCase()}),e.jsx("div",{className:`px-3 py-1 rounded-full border text-[10px] font-bold uppercase tracking-wide ${s.status==="ACTIVE"?"bg-emerald-500/10 border-emerald-500/20 text-emerald-500":s.status==="PENDING"?"bg-amber-500/10 border-amber-500/20 text-amber-500":"bg-red-500/10 border-red-500/20 text-red-500"}`,children:s.status==="ACTIVE"?"Ativo":s.status==="PENDING"?"Pendente":"Suspenso"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white group-hover:text-teal-400 transition-colors truncate",children:s.name}),s.isVerified?e.jsx($,{className:"w-4 h-4 text-cyan-400 drop-shadow-[0_0_8px_rgba(34,211,238,0.5)] flex-shrink-0",title:`Verificado via ${s.verificationSource}`}):e.jsxs("button",{onClick:E=>{E.stopPropagation(),P(s)},title:"Clique para validar",className:"bg-amber-500/10 px-2 py-0.5 rounded-full border border-amber-500/20 flex items-center gap-1 hover:bg-amber-500/20 transition-colors",children:[e.jsx(I,{className:"w-3 h-3 text-amber-500"}),e.jsx("span",{className:"text-[9px] font-bold text-amber-500 uppercase",children:"Validar"})]})]}),e.jsx("p",{className:"text-xs text-slate-500 font-mono mb-4",children:s.email}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-end mb-1",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-600 uppercase",children:"Créditos"}),e.jsxs("span",{className:"text-[10px] font-mono text-slate-400",children:[g,"/",k]})]}),e.jsx("div",{className:"h-1.5 w-full bg-[#111] rounded-full overflow-hidden border border-white/5",children:e.jsx("div",{className:`h-full rounded-full ${A} transition-all duration-500`,style:{width:`${d}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-[#111] rounded-lg p-2 border border-white/5",children:[e.jsx("p",{className:"text-[9px] text-slate-600 font-bold uppercase",children:"NIF"}),e.jsx("p",{className:"text-xs text-slate-300 font-mono",children:s.nif})]}),e.jsxs("div",{className:"bg-[#111] rounded-lg p-2 border border-white/5",children:[e.jsx("p",{className:"text-[9px] text-slate-600 font-bold uppercase",children:"Plano"}),e.jsx("p",{className:"text-xs text-slate-300 font-mono",children:s.plan})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-white/5",children:[e.jsx("button",{onClick:()=>t(s.id),className:"flex-1 bg-white text-black py-2.5 rounded-xl font-bold text-xs uppercase tracking-wide hover:bg-teal-50 transition-colors",children:"Aceder"}),e.jsx("button",{onClick:()=>R(s),className:"p-2.5 rounded-xl bg-[#151515] text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(T,{className:"w-4 h-4"})})]})]},s.id)})}),e.jsx(ge,{isOpen:!!n,onClose:()=>C(null),onConfirm:H,company:n,docCount:K})]})};export{Pe as default};
