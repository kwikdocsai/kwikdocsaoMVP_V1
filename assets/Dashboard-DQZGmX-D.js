import{d as je,r as o,A,a as we,u as Ne,e as Ae,j as e,F as Z,b as Ie,f as ke,Z as Pe}from"./index-DGClD9bb.js";import{f as G,a as Ee}from"./formatters-DUYcZ69c.js";import{D as q}from"./dollar-sign-DJMnEHnQ.js";import{S as se}from"./shield-check-BmpD1UBV.js";import{T as Se}from"./trending-up-CFG_XYXj.js";import{c as H,s as re,a as ne,b as ie,d as De,e as Le,i as Ce,g as J,p as Oe,r as oe,D as $e,u as le,R as Te,S as _e,f as Re,h as de,j as ze,k as Fe,l as Be,m as Me,n as We,o as Ve,Z as Ke,L as Ge,q as ce,t as Q,v as ee,w as He,J as Ue,x as z,y as Ye,C as Xe,z as Ze,A as qe,B as Je,E as Qe}from"./CategoricalChart-DnFD9B4W.js";import{u as et,g as tt,G as at,A as st,D as rt,C as nt,a as it,X as ot,Y as lt,T as dt,b as ct}from"./CartesianChart-_D6tmj0e.js";import{S as xt}from"./ActiveShapeUtils-CWALsybn.js";import{T as mt}from"./triangle-alert-DQX_sNut.js";import{C as xe}from"./circle-alert-B6PDaTPC.js";import{C as me}from"./circle-check-DoWkVmXl.js";import{S as pt}from"./server-VgMOb8-r.js";import{C as ht}from"./circle-x-DIvHKz-v.js";import{F as ut}from"./file-exclamation-point-Bw1nTtJA.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],gt=je("wifi-off",ft);var vt=["children"];function bt(t,a){if(t==null)return{};var r,s,n=yt(t,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function yt(t,a){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(a.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var jt={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},wt=o.createContext(jt);function Nt(t){var{children:a}=t,r=bt(t,vt);return o.createElement(wt.Provider,{value:r},a)}var pe=(t,a,r,s)=>ne(t,"xAxis",a,s),he=(t,a,r,s)=>ie(t,"xAxis",a,s),ue=(t,a,r,s)=>ne(t,"yAxis",r,s),fe=(t,a,r,s)=>ie(t,"yAxis",r,s),At=H([re,pe,ue,he,fe],(t,a,r,s,n)=>Ce(t,"xAxis")?J(a,s,!1):J(r,n,!1)),It=(t,a,r,s,n)=>n;function kt(t){return t.type==="line"}var Pt=H([Le,It],(t,a)=>t.filter(kt).find(r=>r.id===a)),Et=H([re,pe,ue,he,fe,Pt,At,De],(t,a,r,s,n,i,d,c)=>{var{chartData:m,dataStartIndex:l,dataEndIndex:h}=c;if(!(i==null||a==null||r==null||s==null||n==null||s.length===0||n.length===0||d==null||t!=="horizontal"&&t!=="vertical")){var{dataKey:p,data:u}=i,f;if(u!=null&&u.length>0?f=u:f=m==null?void 0:m.slice(l,h+1),f!=null)return Yt({layout:t,xAxis:a,yAxis:r,xAxisTicks:s,yAxisTicks:n,dataKey:p,bandSize:d,displayedData:f})}}),St=["id"],Dt=["type","layout","connectNulls","needClip","shape"],Lt=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function F(){return F=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},F.apply(null,arguments)}function te(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function P(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?te(Object(r),!0).forEach(function(s){Ct(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ct(t,a,r){return(a=Ot(a))in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function Ot(t){var a=$t(t,"string");return typeof a=="symbol"?a:a+""}function $t(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,a);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function U(t,a){if(t==null)return{};var r,s,n=Tt(t,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Tt(t,a){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(a.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var _t=t=>{var{dataKey:a,name:r,stroke:s,legendType:n,hide:i}=t;return[{inactive:i,dataKey:a,type:n,color:s,value:de(r,a),payload:t}]},Rt=o.memo(t=>{var{dataKey:a,data:r,stroke:s,strokeWidth:n,fill:i,name:d,hide:c,unit:m,tooltipType:l,id:h}=t,p={dataDefinedOnItem:r,positions:void 0,settings:{stroke:s,strokeWidth:n,fill:i,dataKey:a,nameKey:void 0,name:de(d,a),hide:c,type:l,color:s,unit:m,graphicalItemId:h}};return o.createElement(ze,{tooltipEntrySettings:p})}),ge=(t,a)=>"".concat(a,"px ").concat(t-a,"px");function zt(t,a){for(var r=t.length%2!==0?[...t,0]:t,s=[],n=0;n<a;++n)s=[...s,...r];return s}var Ft=(t,a,r)=>{var s=r.reduce((p,u)=>p+u);if(!s)return ge(a,t);for(var n=Math.floor(t/s),i=t%s,d=a-t,c=[],m=0,l=0;m<r.length;l+=r[m],++m)if(l+r[m]>i){c=[...r.slice(0,m),i-l];break}var h=c.length%2===0?[0,d]:[d];return[...zt(r,n),...c,...h].map(p=>"".concat(p,"px")).join(", ")};function Bt(t){var{clipPathId:a,points:r,props:s}=t,{dot:n,dataKey:i,needClip:d}=s,{id:c}=s,m=U(s,St),l=qe(m);return o.createElement(rt,{points:r,dot:n,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:l,needClip:d,clipPathId:a})}function Mt(t){var{showLabels:a,children:r,points:s}=t,n=o.useMemo(()=>s==null?void 0:s.map(i=>{var d,c,m={x:(d=i.x)!==null&&d!==void 0?d:0,y:(c=i.y)!==null&&c!==void 0?c:0,width:0,lowerWidth:0,upperWidth:0,height:0};return P(P({},m),{},{value:i.value,payload:i.payload,viewBox:m,parentViewBox:void 0,fill:void 0})}),[s]);return o.createElement(Xe,{value:a?n:void 0},r)}function ae(t){var{clipPathId:a,pathRef:r,points:s,strokeDasharray:n,props:i}=t,{type:d,layout:c,connectNulls:m,needClip:l,shape:h}=i,p=U(i,Dt),u=P(P({},Ze(p)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(a,")"):void 0,points:s,type:d,layout:c,connectNulls:m,strokeDasharray:n??i.strokeDasharray});return o.createElement(o.Fragment,null,(s==null?void 0:s.length)>1&&o.createElement(xt,F({shapeType:"curve",option:h},u,{pathRef:r})),o.createElement(Bt,{points:s,clipPathId:a,props:i}))}function Wt(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function Vt(t){var{clipPathId:a,props:r,pathRef:s,previousPointsRef:n,longestAnimatedLengthRef:i}=t,{points:d,strokeDasharray:c,isAnimationActive:m,animationBegin:l,animationDuration:h,animationEasing:p,animateNewValues:u,width:f,height:y,onAnimationEnd:v,onAnimationStart:E}=r,b=n.current,w=He(d,"recharts-line-"),N=o.useRef(w),[C,D]=o.useState(!1),$=!C,L=o.useCallback(()=>{typeof v=="function"&&v(),D(!1)},[v]),T=o.useCallback(()=>{typeof E=="function"&&E(),D(!0)},[E]),k=Wt(s.current),O=o.useRef(0);N.current!==w&&(O.current=i.current,N.current=w);var _=O.current;return o.createElement(Mt,{points:d,showLabels:$},r.children,o.createElement(Ue,{animationId:w,begin:l,duration:h,isActive:m,easing:p,onAnimationEnd:L,onAnimationStart:T,key:w},x=>{var S=z(_,k+_,x),j=Math.min(S,k),I;if(m)if(c){var V="".concat(c).split(/[,\s]+/gim).map(g=>parseFloat(g));I=Ft(j,k,V)}else I=ge(k,j);else I=c==null?void 0:String(c);if(x>0&&k>0&&(n.current=d,i.current=Math.max(i.current,j)),b){var K=b.length/d.length,R=x===1?d:d.map((g,ye)=>{var Y=Math.floor(ye*K);if(b[Y]){var X=b[Y];return P(P({},g),{},{x:z(X.x,g.x,x),y:z(X.y,g.y,x)})}return u?P(P({},g),{},{x:z(f*2,g.x,x),y:z(y/2,g.y,x)}):P(P({},g),{},{x:g.x,y:g.y})});return n.current=R,o.createElement(ae,{props:r,points:R,clipPathId:a,pathRef:s,strokeDasharray:I})}return o.createElement(ae,{props:r,points:d,clipPathId:a,pathRef:s,strokeDasharray:I})}),o.createElement(Ye,{label:r.label}))}function Kt(t){var{clipPathId:a,props:r}=t,s=o.useRef(null),n=o.useRef(0),i=o.useRef(null);return o.createElement(Vt,{props:r,clipPathId:a,previousPointsRef:s,longestAnimatedLengthRef:n,pathRef:i})}var Gt=(t,a)=>{var r,s;return{x:(r=t.x)!==null&&r!==void 0?r:void 0,y:(s=t.y)!==null&&s!==void 0?s:void 0,value:t.value,errorVal:ce(t.payload,a)}};class Ht extends o.Component{render(){var{hide:a,dot:r,points:s,className:n,xAxisId:i,yAxisId:d,top:c,left:m,width:l,height:h,id:p,needClip:u,zIndex:f}=this.props;if(a)return null;var y=We("recharts-line",n),v=p,{r:E,strokeWidth:b}=tt(r),w=Ve(r),N=E*2+b,C=u?"url(#clipPath-".concat(w?"":"dots-").concat(v,")"):void 0;return o.createElement(Ke,{zIndex:f},o.createElement(Ge,{className:y},u&&o.createElement("defs",null,o.createElement(at,{clipPathId:v,xAxisId:i,yAxisId:d}),!w&&o.createElement("clipPath",{id:"clipPath-dots-".concat(v)},o.createElement("rect",{x:m-N/2,y:c-N/2,width:l+N,height:h+N}))),o.createElement(Nt,{xAxisId:i,yAxisId:d,data:s,dataPointFormatter:Gt,errorBarOffset:0},o.createElement(Kt,{props:this.props,clipPathId:v}))),o.createElement(st,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:C}))}}var ve={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:$e.line,type:"linear"};function Ut(t){var a=oe(t,ve),{activeDot:r,animateNewValues:s,animationBegin:n,animationDuration:i,animationEasing:d,connectNulls:c,dot:m,hide:l,isAnimationActive:h,label:p,legendType:u,xAxisId:f,yAxisId:y,id:v}=a,E=U(a,Lt),{needClip:b}=et(f,y),w=Fe(),N=Be(),C=le(),D=Me(O=>Et(O,f,y,C,v));if(N!=="horizontal"&&N!=="vertical"||D==null||w==null)return null;var{height:$,width:L,x:T,y:k}=w;return o.createElement(Ht,F({},E,{id:v,connectNulls:c,dot:m,activeDot:r,animateNewValues:s,animationBegin:n,animationDuration:i,animationEasing:d,isAnimationActive:h,hide:l,label:p,legendType:u,xAxisId:f,yAxisId:y,points:D,layout:N,height:$,width:L,left:T,top:k,needClip:b}))}function Yt(t){var{layout:a,xAxis:r,yAxis:s,xAxisTicks:n,yAxisTicks:i,dataKey:d,bandSize:c,displayedData:m}=t;return m.map((l,h)=>{var p=ce(l,d);if(a==="horizontal"){var u=Q({axis:r,ticks:n,bandSize:c,entry:l,index:h}),f=ee(p)?null:s.scale(p);return{x:u,y:f,value:p,payload:l}}var y=ee(p)?null:r.scale(p),v=Q({axis:s,ticks:i,bandSize:c,entry:l,index:h});return y==null||v==null?null:{x:y,y:v,value:p,payload:l}}).filter(Boolean)}function Xt(t){var a=oe(t,ve),r=le();return o.createElement(Te,{id:a.id,type:"line"},s=>o.createElement(o.Fragment,null,o.createElement(_e,{legendPayload:_t(a)}),o.createElement(Rt,{dataKey:a.dataKey,data:a.data,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.fill,name:a.name,hide:a.hide,unit:a.unit,tooltipType:a.tooltipType,id:s}),o.createElement(Re,{type:"line",id:s,data:a.data,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,dataKey:a.dataKey,hide:a.hide,isPanorama:r}),o.createElement(Ut,F({},a,{id:s}))))}var be=o.memo(Xt,Oe);be.displayName="Line";var Zt=["axis"],qt=o.forwardRef((t,a)=>o.createElement(nt,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Zt,tooltipPayloadSearcher:Je,categoricalChartProps:t,ref:a}));const B={async getHeadlineMetrics(t,a){const r=localStorage.getItem("auth_token"),s=await fetch(`${A}/dashboard/metrics?companyId=${t}&period=${a}`,{headers:{Authorization:`Bearer ${r}`}});if(!s.ok)throw new Error("Erro ao carregar métricas");return await s.json()},async getSpendingTrend(t,a){const r=localStorage.getItem("auth_token"),s=await fetch(`${A}/dashboard/spending-trend?companyId=${t}&period=${a}`,{headers:{Authorization:`Bearer ${r}`}});if(!s.ok)throw new Error("Erro ao carregar tendências");return(await s.json()).map(i=>({name:new Date(i.date).toLocaleDateString("pt-AO",{day:"2-digit",month:"short"}),amount:parseFloat(i.amount),fullDate:i.date}))},async getCategoryDistribution(t){const a=localStorage.getItem("auth_token"),r=await fetch(`${A}/dashboard/category-distribution?companyId=${t}`,{headers:{Authorization:`Bearer ${a}`}});if(!r.ok)throw new Error("Erro ao carregar distribuição");return(await r.json()).map(n=>({name:n.name,value:parseFloat(n.value)}))},async getRecentActivity(t){const a=localStorage.getItem("auth_token"),r=await fetch(`${A}/dashboard/recent-activity?companyId=${t}`,{headers:{Authorization:`Bearer ${a}`}});if(!r.ok)throw new Error("Erro ao carregar atividade recente");return await r.json()},async getPortfolioHealth(){const t=localStorage.getItem("auth_token"),a=await fetch(`${A}/dashboard/portfolio-health`,{headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error("Erro ao carregar saúde do portfólio");return(await a.json()).map(s=>{let n="N/A";if(s.lastDoc){const i=new Date(s.lastDoc),d=(new Date().getTime()-i.getTime())/(1e3*3600);d<24?n="Hoje":d<48?n="Ontem":n=`${Math.floor(d/24)} dias atrás`}return{id:s.id,name:s.name,status:s.status,issues:s.issues,lastDoc:n}})},async getAiInsights(t){const a=t||"",r=localStorage.getItem("auth_token"),s=await fetch(`${A}/dashboard/ai-insights?companyId=${a}`,{headers:{Authorization:`Bearer ${r}`}});if(!s.ok){const n=await s.json();throw new Error(n.error||"Erro ao carregar insights de IA")}return await s.json()},async getFiscalAnalytics(t){const a=localStorage.getItem("auth_token"),r=await fetch(`${A}/reports/analytics?companyId=${t}`,{headers:{Authorization:`Bearer ${a}`}});if(!r.ok)throw new Error("Erro ao carregar análise fiscal");return await r.json()},async getFiscalDistribution(t,a,r){const s=localStorage.getItem("auth_token");let n=`${A}/reports/distribution?companyId=${t}`;a&&(n+=`&startDate=${a}`),r&&(n+=`&endDate=${r}`);const i=await fetch(n,{headers:{Authorization:`Bearer ${s}`}});if(!i.ok)throw new Error("Erro ao carregar distribuição fiscal");return await i.json()},async generateVatMap(t,a,r){const s=localStorage.getItem("auth_token"),n=await fetch(`${A}/reports/vat-map?companyId=${t}&month=${a}&year=${r}`,{headers:{Authorization:`Bearer ${s}`}});if(!n.ok)throw new Error("Erro ao gerar mapa de IVA");return await n.json()},async getComplianceLogs(t){const a=localStorage.getItem("auth_token"),r=await fetch(`${A}/system/compliance-logs?companyId=${t}`,{headers:{Authorization:`Bearer ${a}`}});if(!r.ok)throw new Error("Erro ao carregar logs de conformidade");return await r.json()},async getTaxPosition(t,a,r){const s=localStorage.getItem("auth_token"),n=await fetch(`${A}/reports/tax-position?companyId=${t}&month=${a}&year=${r}`,{headers:{Authorization:`Bearer ${s}`}});if(!n.ok)throw new Error("Erro ao carregar posição fiscal");return await n.json()}},W=({children:t,className:a="",title:r,subtitle:s,label:n,action:i,neonColor:d="cyan"})=>e.jsxs("div",{className:`relative bg-[#080808] border border-white/[0.03] rounded-[32px] p-6 md:p-8 flex flex-col overflow-hidden shadow-2xl ${a}`,children:[(r||n)&&e.jsxs("div",{className:"flex justify-between items-start mb-6 z-10",children:[e.jsxs("div",{className:"space-y-1",children:[n&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${d==="cyan"?"bg-cyan-500":"bg-teal-500"}`}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:n})]}),r&&e.jsx("h3",{className:"text-2xl font-bold text-white tracking-tight",children:r}),s&&e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:s})]}),i&&e.jsx("div",{children:i})]}),e.jsx("div",{className:"relative z-10 flex-1",children:t}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-[rgba(20,184,166,0.02)] to-transparent pointer-events-none"})]}),M=({value:t,label:a,subtext:r,icon:s,trend:n,color:i="cyan",loading:d})=>{const c={cyan:"text-cyan-400",blue:"text-blue-400",teal:"text-teal-400",emerald:"text-emerald-400",indigo:"text-indigo-400",rose:"text-rose-400"},m={cyan:"bg-cyan-500/10",blue:"bg-blue-500/10",teal:"bg-teal-500/10",emerald:"bg-emerald-500/10",indigo:"bg-indigo-500/10",rose:"bg-rose-500/10"};return e.jsxs("div",{className:"bg-[#0c0c0c] rounded-[28px] border border-white/[0.04] p-6 relative group hover:border-white/10 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:`p-3 rounded-xl border border-white/5 ${m[i]} ${c[i]}`,children:e.jsx(s,{className:"w-5 h-5"})}),n&&e.jsxs("div",{className:"px-2 py-1 rounded-lg bg-[#151515] border border-white/5 text-[10px] font-bold text-slate-300",children:[n>0?"+":"",n,"%"]})]}),e.jsxs("div",{children:[d?e.jsx("div",{className:"h-10 w-24 bg-white/5 animate-pulse rounded-lg mb-2"}):e.jsx("h2",{className:"text-4xl font-bold text-white mb-1 tracking-tighter",children:t}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:a}),r&&e.jsx("p",{className:"text-[10px] text-slate-600 mt-2 font-mono",children:r})]})]})},Jt=({approved:t,approvedManual:a,rejected:r,error:s,total:n})=>{const i=n>0?t/n*100:0,d=n>0?a/n*100:0,c=n>0?r/n*100:0,m=n>0?s/n*100:0;return e.jsx(W,{title:"Saúde Documental",label:"Processamento",className:"h-full",children:e.jsxs("div",{className:"flex flex-col h-full justify-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-emerald-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-300",children:"Validados AI"})]}),e.jsxs("span",{className:"text-sm font-mono font-bold text-white",children:[t," ",e.jsxs("span",{className:"text-slate-600 text-[10px]",children:["(",isNaN(i)?0:i.toFixed(0),"%)"]})]})]}),e.jsx("div",{className:"h-2 w-full bg-[#151515] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500/60",style:{width:`${i}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-300",children:"Aprovados (Manual)"})]}),e.jsxs("span",{className:"text-sm font-mono font-bold text-white",children:[a," ",e.jsxs("span",{className:"text-slate-600 text-[10px]",children:["(",isNaN(d)?0:d.toFixed(0),"%)"]})]})]}),e.jsx("div",{className:"h-2 w-full bg-[#151515] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-cyan-500",style:{width:`${d}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ht,{className:"w-4 h-4 text-rose-500"}),e.jsx("span",{className:"text-xs font-bold text-slate-300",children:"Rejeitados"})]}),e.jsxs("span",{className:"text-sm font-mono font-bold text-white",children:[r," ",e.jsxs("span",{className:"text-slate-600 text-[10px]",children:["(",isNaN(c)?0:c.toFixed(0),"%)"]})]})]}),e.jsx("div",{className:"h-2 w-full bg-[#151515] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-rose-500",style:{width:`${c}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-xs font-bold text-slate-300",children:"Erros"})]}),e.jsxs("span",{className:"text-sm font-mono font-bold text-white",children:[s," ",e.jsxs("span",{className:"text-slate-600 text-[10px]",children:["(",isNaN(m)?0:m.toFixed(0),"%)"]})]})]}),e.jsx("div",{className:"h-2 w-full bg-[#151515] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-amber-500",style:{width:`${m}%`}})})]})]})})},Qt=({companyName:t,isAccounting:a,isVerified:r,companyId:s})=>{const[n,i]=o.useState(null),[d,c]=o.useState([]);o.useEffect(()=>{if(!s||s==="ALL")return;(async()=>{try{const p=localStorage.getItem("auth_token"),[u,f]=await Promise.all([fetch(`${A}/servers/status?companyId=${s}`,{headers:{Authorization:`Bearer ${p}`}}),fetch(`${A}/server-plans`,{headers:{Authorization:`Bearer ${p}`}})]);if(u.ok){const y=await u.json();y.status==="ACTIVE"&&i(y)}f.ok&&c(await f.json())}catch(p){console.error("Header fetch error",p)}})()},[s]);const m=d.find(h=>h.slug===(n==null?void 0:n.server_type)),l=m?m.name:(n==null?void 0:n.server_type)||"Nenhum Ativo";return e.jsxs("div",{className:"w-full bg-[#080808] border border-white/[0.03] rounded-[32px] p-6 md:p-8 mb-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-teal-500/5 blur-[120px] rounded-full pointer-events-none -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-end gap-6 text-left",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:`animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 ${n?"bg-emerald-400":"bg-slate-400"}`}),e.jsx("span",{className:`relative inline-flex rounded-full h-2 w-2 ${n?"bg-emerald-500":"bg-slate-500"}`})]}),e.jsxs("span",{className:"text-[10px] font-bold text-teal-500 uppercase tracking-widest",children:["Infraestrutura Operacional • ",n?"ONLINE":"OFFLINE"]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(Ie,{className:"w-48 h-12 md:w-72 md:h-20",iconClassName:"w-full h-full"})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap max-w-lg",children:[e.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm leading-relaxed",children:["Visualização central de inteligência documental para",e.jsx("span",{className:"text-white font-bold mx-1",children:a?"Carteira Global":t}),"."]}),!a&&(r?e.jsx(se,{className:"w-5 h-5 text-cyan-400 drop-shadow-[0_0_8px_rgba(34,211,238,0.6)]",title:"Entidade Verificada AGT"}):e.jsx(xe,{className:"w-5 h-5 text-red-500",title:"Entidade Não Verificada"}))]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row lg:flex-row gap-6 items-start lg:items-end w-full lg:w-auto",children:[e.jsxs("div",{className:"text-left lg:text-right",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1",children:"Agentes AI"}),e.jsxs("p",{className:"text-xl font-bold text-white font-mono flex items-center lg:justify-end gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"})," Online"]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs("button",{className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-[#151515] border border-white/10 hover:border-teal-500/50 hover:text-teal-400 transition-all text-[10px] font-bold text-white uppercase tracking-wider",children:[e.jsx(ke,{className:"w-3 h-3"})," Relatórios"]}),n&&e.jsxs("div",{className:"flex-1 sm:flex-none px-4 py-2 rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-[10px] font-bold uppercase tracking-widest flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(16,185,129,0.1)]",children:[e.jsx(pt,{className:"w-3 h-3"})," ",l]})]})]})]})]})},ha=()=>{var O,_;const{selectedCompany:t,isAccountingMode:a,documents:r,isLoadingData:s}=we(),{user:n}=Ne(),[i,d]=o.useState("30D"),[c,m]=o.useState(!0),[l,h]=o.useState(null),[p,u]=o.useState([]),[f,y]=o.useState([]),[v,E]=o.useState([]),b=t==="ALL"||!t?"ALL":t.id,w=t==="ALL"?"Carteira Global":t==null?void 0:t.name,N=t!=="ALL"&&(t==null?void 0:t.isVerified),C=t==="ALL"||(t==null?void 0:t.id)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t.id),D=!s&&C;o.useEffect(()=>{if(!D)return;(async()=>{console.log("[DASHBOARD DIAGNOSTIC] Fetching data.",{companyName:w,companyId:b,idType:typeof b,selectedCompId:t==null?void 0:t.id}),m(!0);try{const[S,j,I,V]=await Promise.all([B.getHeadlineMetrics(b,i),B.getSpendingTrend(b,i),B.getAiInsights(b),B.getRecentActivity(b)]),K=j.length>0?j[j.length-1].amount:0,R=j.map(g=>({...g,prediction:null}));for(let g=1;g<=3;g++)R.push({name:`Proj +${g}`,amount:0,prediction:K*(1+g*.05),isProjection:!0});h(S),u(R),y(I),E(V)}catch(S){console.error("Dashboard Load Error:",S)}finally{m(!1)}})()},[b,i,D]);const $=((_=(O=f.find(x=>x.severity==="OPPORTUNITY"))==null?void 0:O.metadata)==null?void 0:_.potential_savings)||0,L=(l==null?void 0:l.statusCounts)||{approved:0,approvedManual:0,rejected:0,error:0},{isOnline:T,pendingCount:k}=Ae();return s&&!l?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-teal-500/20 border-t-teal-500"}),e.jsx("p",{className:"animate-pulse text-sm font-medium text-slate-500",children:"A carregar dashboard..."})]})}):e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-8 duration-700 pb-10",children:[!T&&e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-[24px] p-6 flex items-center gap-4 animate-in fade-in slide-in-from-top-4 duration-500 mb-8",children:[e.jsx("div",{className:"p-3 bg-amber-500/20 rounded-xl",children:e.jsx(gt,{className:"w-6 h-6 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:"Modo Offline"}),e.jsx("p",{className:"text-slate-400",children:"Você está desconectado. Documentos capturados serão salvos no dispositivo e sincronizados automaticamente quando a conexão retornar."})]}),k>0&&e.jsxs("div",{className:"ml-auto bg-amber-500/20 px-4 py-2 rounded-full border border-amber-500/30",children:[e.jsx("span",{className:"text-amber-400 font-mono font-bold",children:k}),e.jsx("span",{className:"text-amber-500/70 text-sm ml-2",children:"pendentes"})]})]}),e.jsx(Qt,{companyName:w,isAccounting:a,isVerified:N,companyId:b}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(M,{loading:c,label:"Volume Analisado",value:(l==null?void 0:l.docCount)||0,trend:l==null?void 0:l.growthRate,icon:Z,color:"blue",subtext:"Documentos processados"}),e.jsx(M,{value:c?"-":G((l==null?void 0:l.totalSpend)||0),label:"Total Despesas",subtext:`Média: ${G((l==null?void 0:l.avgSpend)||0)}`,icon:q,color:"indigo",loading:c}),e.jsx(M,{value:c?"-":`${(l==null?void 0:l.efficiencyScore)??100}%`,label:"Conformidade AGT",subtext:"Validação Técnica SAFT (AO)",icon:se,trend:.5,color:"teal",loading:c}),e.jsx(M,{value:c?"-":G($),label:"Eficiência Fiscal",subtext:"Poupança Estimada (Modelo 6)",icon:Se,trend:$>0?100:0,color:"emerald",loading:c})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx(W,{className:"lg:col-span-2 min-h-[400px]",title:"Análise Neural de Fluxo",label:"Predictor AI Forecast",neonColor:"cyan",action:e.jsx("div",{className:"flex bg-[#111] p-1 rounded-xl border border-white/5",children:["7D","30D","90D"].map(x=>e.jsx("button",{onClick:()=>d(x),className:`px-3 py-1 text-[10px] font-bold rounded-lg transition-all ${i===x?"bg-[#14b8a6] text-black":"text-slate-500 hover:text-white"}`,children:x},x))}),children:e.jsxs("div",{className:"w-full h-[300px] mt-6",children:[c?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 border-4 border-[#151515] border-t-[#14b8a6] rounded-full animate-spin"})}):e.jsx("div",{className:"w-full h-[300px] relative min-h-[300px]",children:e.jsx(Qe,{width:"100%",height:"100%",children:e.jsxs(qt,{data:p,margin:{top:10,right:0,left:-20,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorTeal",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#14b8a6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#14b8a6",stopOpacity:0})]})}),e.jsx(it,{strokeDasharray:"3 3",vertical:!1,stroke:"rgba(255,255,255,0.03)"}),e.jsx(ot,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#475569",fontSize:10,fontWeight:700,fontFamily:"monospace"},dy:15}),e.jsx(lt,{axisLine:!1,tickLine:!1,tick:{fill:"#475569",fontSize:10,fontWeight:700,fontFamily:"monospace"},tickFormatter:x=>`${(x/1e3).toFixed(0)}k`}),e.jsx(dt,{contentStyle:{backgroundColor:"#050505",borderColor:"#333",borderRadius:"12px"},itemStyle:{color:"#fff",fontSize:"12px",fontWeight:"bold"}}),e.jsx(ct,{type:"monotone",dataKey:"amount",stroke:"#14b8a6",strokeWidth:3,fillOpacity:1,fill:"url(#colorTeal)",name:"Realizado"}),e.jsx(be,{type:"monotone",dataKey:"prediction",stroke:"#10b981",strokeWidth:2,strokeDasharray:"5 5",dot:!1,name:"Projeção AI"})]})})}),e.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#14b8a6]"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Histórico"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Projeção Predictor"})]})]})]})}),e.jsx(Jt,{approved:L.approved,approvedManual:L.approvedManual,rejected:L.rejected,error:L.error,total:(l==null?void 0:l.docCount)||0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(W,{title:"Últimas Análises",label:"Live Feed",className:"h-full",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"pb-3 text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Documento"}),e.jsx("th",{className:"pb-3 text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"pb-3 text-[10px] font-bold text-slate-500 uppercase tracking-wider text-right",children:"Valor"}),e.jsx("th",{className:"pb-3 text-[10px] font-bold text-slate-500 uppercase tracking-wider text-right",children:"Data"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:v.length>0?v.map((x,S)=>e.jsxs("tr",{className:"group hover:bg-white/[0.02] transition-colors",children:[e.jsx("td",{className:"py-3 pr-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-[#151515] border border-white/5 text-slate-400",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-xs font-bold text-white truncate max-w-[120px]",children:x.filename})]})}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase border ${x.status==="APROVADO"?"bg-emerald-500/10 text-emerald-400 border-emerald-500/20":x.status==="REJEITADO"?"bg-rose-500/10 text-rose-400 border-rose-500/20":"bg-amber-500/10 text-amber-400 border-amber-500/20"}`,children:x.status})}),e.jsx("td",{className:"py-3 text-right",children:e.jsx("span",{className:"text-xs font-mono font-bold text-slate-300",children:Ee(x.amount)})}),e.jsx("td",{className:"py-3 text-right",children:e.jsx("span",{className:"text-[10px] text-slate-500 font-mono",children:new Date(x.date).toLocaleDateString()})})]},S)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-8 text-center text-xs text-slate-500",children:"Nenhuma atividade recente."})})})]})})}),e.jsx(W,{title:"Alertas do Sistema",label:"Sentinel & Optimizer",className:"h-full",children:e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:f.length>0?f.map((x,S)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-white/[0.02] border border-white/5 hover:bg-white/[0.04] transition-colors group",children:[e.jsx("div",{className:`mt-1 p-1.5 rounded-lg border ${x.severity==="CRITICAL"?"bg-red-500/10 text-red-400 border-red-500/10":x.severity==="WARNING"?"bg-amber-500/10 text-amber-400 border-amber-500/10":x.severity==="OPPORTUNITY"?"bg-emerald-500/10 text-emerald-400 border-emerald-500/10":"bg-blue-500/10 text-blue-400 border-blue-500/10"}`,children:x.severity==="CRITICAL"?e.jsx(mt,{className:"w-3 h-3"}):x.severity==="OPPORTUNITY"?e.jsx(q,{className:"w-3 h-3"}):e.jsx(xe,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-200",children:x.title}),e.jsx("span",{className:"text-[9px] font-bold text-slate-500 bg-white/5 px-1.5 py-0.5 rounded uppercase",children:x.agent_name})]}),e.jsx("p",{className:"text-[10px] text-slate-400 leading-relaxed mb-2 break-words",children:x.message}),x.metadata&&e.jsxs("div",{className:"space-y-2 mt-2",children:[Array.isArray(x.metadata.risks)&&x.metadata.risks.length>0&&e.jsxs("div",{className:"bg-rose-500/5 border border-rose-500/10 rounded-lg p-2",children:[e.jsx("p",{className:"text-[9px] font-bold text-rose-400 uppercase mb-1 flex items-center gap-1",children:"⚠️ Riscos Identificados"}),e.jsx("ul",{className:"list-disc list-inside space-y-0.5",children:x.metadata.risks.slice(0,3).map((j,I)=>e.jsx("li",{className:"text-[9px] text-slate-400 pl-1",children:j},I))})]}),Array.isArray(x.metadata.opportunities)&&x.metadata.opportunities.length>0&&e.jsxs("div",{className:"bg-emerald-500/5 border border-emerald-500/10 rounded-lg p-2",children:[e.jsx("p",{className:"text-[9px] font-bold text-emerald-400 uppercase mb-1 flex items-center gap-1",children:"✨ Oportunidades"}),e.jsx("ul",{className:"space-y-1",children:x.metadata.opportunities.slice(0,2).map((j,I)=>e.jsxs("li",{className:"text-[9px] text-slate-400 flex justify-between",children:[e.jsx("span",{children:j.title||j}),j.potential_savings&&e.jsx("span",{className:"font-mono text-emerald-500",children:j.potential_savings})]},I))})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-[9px] text-slate-600 font-mono",children:new Date(x.created_at||Date.now()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),!x.is_resolved&&e.jsx("button",{className:"text-[9px] font-bold text-emerald-500 hover:underline",children:"MARCAR COMO RESOLVIDO"})]})]})]},S)):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-500",children:[e.jsx(me,{className:"w-8 h-8 mb-3 opacity-20 text-emerald-500"}),e.jsx("p",{className:"text-xs font-medium text-emerald-500/50",children:"Fluxo Limpo"})]})})})]})]})};export{ha as default};
