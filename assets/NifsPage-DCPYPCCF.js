import{d as N,a as v,r,p as y,j as e,B as u,g as k}from"./index-J78_TlI6.js";import{utils as d,writeFile as E}from"./xlsx-ebvMUq42.js";import{R as C}from"./refresh-cw-cEns_5UH.js";import{D as A}from"./download-DWa1ktEb.js";import{I as S}from"./inbox-DIkqRg9h.js";import{A as I,m as _}from"./proxy-C8CbA8UD.js";import{L}from"./landmark-B-4IgFVE.js";import{S as z}from"./shield-check-BAy-76FJ.js";import{C as R}from"./circle-alert-D8Dqr4sO.js";import{B as T}from"./briefcase-CV3vTCio.js";import{C as D,E as F}from"./external-link-Csz6evuL.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],B=N("ellipsis-vertical",V),W=()=>{const{selectedCompany:i}=v(),[l,f]=r.useState([]),[b,x]=r.useState(!0),[n,g]=r.useState(""),[o,m]=r.useState(!1);r.useEffect(()=>{h()},[i]);const h=async()=>{x(!0);try{const t=i&&i!=="ALL"?i.id:void 0,s=await y.getFiscalEntities(t);f(s)}catch(t){console.error("Failed to fetch entities:",t)}finally{x(!1),m(!1)}},w=()=>{m(!0),h()},j=()=>{const t=d.json_to_sheet(c.map(a=>({NIF:a.nif,Empresa:a.name,Regime:a.tax_regime||"N/A",Status:a.status,"Última Atividade":new Date(a.last_seen_at).toLocaleDateString()}))),s=d.book_new();d.book_append_sheet(s,t,"Entidades NIF"),E(s,`entidades_${new Date().getTime()}.xlsx`)},c=l.filter(t=>{var s,a;return((s=t.name)==null?void 0:s.toLowerCase().includes(n.toLowerCase()))||((a=t.nif)==null?void 0:a.includes(n))}),p={total:l.length,active:l.filter(t=>t.status==="ACTIVE").length,pending:l.filter(t=>t.status!=="ACTIVE").length};return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-700 pb-20 p-6 md:p-8 bg-[#050505] min-h-screen",children:[e.jsxs("div",{className:"bg-[#0a0a0a] border border-white/[0.03] p-10 rounded-[32px] relative overflow-hidden group shadow-2xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-12 opacity-5 scale-150 rotate-12 group-hover:opacity-10 transition-all duration-700",children:e.jsx(u,{size:200,className:"text-cyan-500"})}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-end gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-500 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]",children:"Inteligência Cadastral"})]}),e.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter sm:text-5xl",children:"Catálogo de Entidades"}),e.jsx("p",{className:"text-slate-400 mt-2 font-medium max-w-xl",children:"Gerencie fornecedores, clientes e parceiros fiscais detectados em seus documentos através de análise inteligente."})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"bg-white/5 border border-white/10 px-6 py-4 rounded-2xl backdrop-blur-md",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-1",children:"Entidades Totais"}),e.jsx("p",{className:"text-2xl font-black text-white font-mono",children:p.total})]}),e.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 px-6 py-4 rounded-2xl backdrop-blur-md",children:[e.jsx("p",{className:"text-[10px] font-bold text-emerald-500/60 uppercase tracking-widest mb-1",children:"Status Ativo"}),e.jsx("p",{className:"text-2xl font-black text-emerald-400 font-mono",children:p.active})]})]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 w-full group",children:[e.jsx(k,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 group-focus-within:text-cyan-400 transition-colors"}),e.jsx("input",{type:"text",placeholder:"Pesquisar por NIF, Nome ou Regime...",className:"w-full bg-[#0a0a0a] border border-white/5 rounded-2xl py-4 pl-12 pr-4 text-sm text-white placeholder-slate-600 focus:outline-none focus:border-cyan-500/50 focus:ring-4 focus:ring-cyan-500/10 transition-all font-bold shadow-lg",value:n,onChange:t=>g(t.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto",children:[e.jsxs("button",{onClick:w,className:`flex items-center gap-2 px-6 py-4 rounded-2xl border border-white/10 bg-[#0a0a0a] text-slate-400 hover:text-white transition-all hover:bg-white/5 ${o?"opacity-50":""}`,disabled:o,children:[e.jsx(C,{className:`w-4 h-4 ${o?"animate-spin":""}`}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Atualizar"})]}),e.jsxs("button",{onClick:j,className:"flex-1 lg:flex-none flex items-center justify-center gap-2 px-8 py-4 bg-cyan-500 text-black rounded-2xl font-black text-xs uppercase tracking-widest transition-all hover:bg-cyan-400 active:scale-95 shadow-lg shadow-cyan-500/20",children:[e.jsx(A,{className:"w-4 h-4"}),"Exportar Excel"]})]})]}),b?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(t=>e.jsx("div",{className:"h-64 bg-white/5 rounded-[32px] border border-white/5 animate-pulse"},t))}):c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-[#0a0a0a] border border-dashed border-white/10 rounded-[40px]",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/5 flex items-center justify-center mb-6",children:e.jsx(S,{className:"w-10 h-10 text-slate-700"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Nenhuma entidade encontrada"}),e.jsx("p",{className:"text-slate-500 text-sm max-w-sm text-center",children:"Ainda não detectamos entidades para esta empresa. O catálogo é preenchido automaticamente ao processar faturas e recibos."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(I,{mode:"popLayout",children:c.map((t,s)=>e.jsxs(_.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},transition:{duration:.4,delay:s*.05},className:"group bg-[#0a0a0a] border border-white/5 rounded-[32px] p-8 hover:border-cyan-500/30 hover:shadow-2xl hover:shadow-cyan-500/5 transition-all relative overflow-hidden flex flex-col",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:opacity-[0.05] transition-opacity",children:e.jsx(L,{size:100})}),e.jsxs("div",{className:"flex justify-between items-start mb-6 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-cyan-500/10 border border-cyan-500/20 flex items-center justify-center",children:e.jsx(u,{className:"w-7 h-7 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-black text-white group-hover:text-cyan-400 transition-colors uppercase truncate max-w-[180px]",children:t.name||"Sem Nome"}),e.jsx("span",{className:"text-xs font-mono text-slate-500",children:t.nif})]})]}),e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[9px] font-black uppercase tracking-wider ${t.status==="ACTIVE"?"bg-emerald-500/10 text-emerald-400":"bg-amber-500/10 text-amber-400"}`,children:[t.status==="ACTIVE"?e.jsx(z,{size:12}):e.jsx(R,{size:12}),t.status==="ACTIVE"?"Regular":"Pendente"]})]}),e.jsxs("div",{className:"space-y-3 relative z-10 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-400 font-bold bg-white/[0.02] p-3 rounded-2xl border border-white/5",children:[e.jsx(T,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{children:"Regime Tributário"}),e.jsx("span",{className:"text-white ml-auto",children:t.tax_regime||"Geral"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-400 font-bold bg-white/[0.02] p-3 rounded-2xl border border-white/5",children:[e.jsx(D,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{children:"Última Atividade"}),e.jsx("span",{className:"text-white ml-auto",children:new Date(t.last_seen_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-white/5 flex gap-3 relative z-10",children:[e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 py-3.5 bg-white/5 border border-white/10 rounded-2xl text-[11px] font-black uppercase tracking-widest text-slate-400 hover:text-white hover:bg-white/10 hover:border-white/20 transition-all",children:[e.jsx(F,{size:14})," Detalhes"]}),e.jsx("button",{className:"px-4 flex items-center justify-center bg-white/5 border border-white/10 rounded-2xl text-slate-500 hover:text-white transition-all",children:e.jsx(B,{size:18})})]})]},t.id))})})]})};export{W as default};
