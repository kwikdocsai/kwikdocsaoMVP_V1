import{r as n,j as e,l as g,Z as j,a as v,f as N,n as w}from"./index-CM-BcqkI.js";import{a as m,f as y}from"./formatters-DUYcZ69c.js";import{S as k}from"./sparkles-DzL-l0Hb.js";import{A as S}from"./arrow-right-DT5qkfQy.js";import{S as f}from"./shield-check-FByxqXQK.js";import{X as A}from"./x-DuomGLEF.js";import{T as C}from"./triangle-alert-DK0Clz4a.js";import{C as T}from"./chevron-right-D6l-kwwe.js";import{T as R}from"./trending-up-DNOUwGEh.js";import{T as D}from"./trending-down-si02yOGH.js";import{L as I}from"./landmark-BMkC9oqW.js";import{B as E,E as L}from"./CategoricalChart-Cd0IKika.js";import{C as z,a as F,X as $,Y as O,T as _,b as u}from"./CartesianChart-DOOg3O3E.js";import{A as V}from"./arrow-up-right-CITw61xJ.js";import{A as W}from"./arrow-down-right-NjpNvSZx.js";import{I as K}from"./info-BU9dFrxj.js";var M=["axis"],P=n.forwardRef((t,l)=>n.createElement(z,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:M,tooltipPayloadSearcher:E,categoricalChartProps:t,ref:l}));const G=({risks:t,loading:l,onViewDetails:r})=>{const[d,a]=n.useState(!1),[i,o]=n.useState(null),c=t&&t.length>0;return e.jsxs("div",{className:"bg-[#080808] border border-white/[0.03] rounded-[40px] p-8 shadow-2xl flex flex-col relative overflow-hidden h-full group",children:[e.jsx("div",{className:`absolute -top-20 -right-20 w-64 h-64 rounded-full blur-[80px] transition-all duration-1000 ${c?"bg-amber-500/10":"bg-cyan-500/10"}`}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`absolute inset-0 rounded-2xl blur-lg animate-pulse ${c?"bg-amber-500/20":"bg-cyan-500/20"}`}),e.jsx("div",{className:`p-4 rounded-2xl border relative z-10 ${c?"bg-amber-500/10 border-amber-500/20 text-amber-400":"bg-cyan-500/10 border-cyan-500/20 text-cyan-400"}`,children:e.jsx(g,{className:`w-6 h-6 ${l?"animate-spin":""}`})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-black text-xl tracking-tight flex items-center gap-2",children:["Sentinela Fiscal 2.0",e.jsx(k,{className:"w-4 h-4 text-cyan-400 animate-pulse"})]}),e.jsx("p",{className:"text-slate-500 text-[10px] font-bold uppercase tracking-widest",children:"IA de Auditoria em Tempo Real"})]})]})}),e.jsx("div",{className:"flex-1 space-y-4",children:l?e.jsxs("div",{className:"py-20 flex flex-col items-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-xs text-slate-500 animate-pulse uppercase tracking-[0.2em] font-black",children:"Analisando Padrões..."})]}):c?e.jsx("div",{className:"space-y-3",children:t.slice(0,3).map((x,h)=>e.jsxs("div",{onClick:()=>o(x),className:"p-4 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-amber-500/30 hover:bg-white/[0.05] transition-all cursor-pointer group/item",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:"Risco Detectado"})]}),e.jsxs("span",{className:"text-[9px] font-mono text-slate-600",children:["CASOS: ",x.count]})]}),e.jsx("p",{className:"text-xs text-slate-300 leading-relaxed font-medium line-clamp-2",children:x.alert}),e.jsx("div",{className:"flex justify-end mt-2 opacity-0 group-hover/item:opacity-100 transition-opacity",children:e.jsxs("div",{className:"text-[9px] font-bold text-cyan-400 flex items-center gap-1",children:["VER IMPACTO ",e.jsx(S,{className:"w-3 h-3"})]})})]},h))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 blur-2xl rounded-full scale-150"}),e.jsx(f,{className:"w-16 h-16 text-emerald-500 relative z-10"})]}),e.jsx("p",{className:"text-sm text-white font-bold mb-1",children:"Céu Limpo"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-medium max-w-[200px] leading-relaxed",children:"Nenhuma inconsistência grave detectada pelos agentes de IA nesta empresa."})]})}),e.jsx("div",{className:"mt-8",children:e.jsxs("button",{onClick:()=>r==null?void 0:r(t),className:"w-full py-4 rounded-[20px] bg-white/5 border border-white/10 text-white text-[10px] font-black uppercase tracking-widest hover:bg-white/10 hover:border-white/20 transition-all flex items-center justify-center gap-2 shadow-xl group/btn",children:["Relatório Detalhado de IA",e.jsx("div",{className:"p-1 rounded bg-cyan-500/10 text-cyan-400 group-hover/btn:bg-cyan-500 group-hover/btn:text-black transition-all",children:e.jsx(j,{className:"w-3 h-3 fill-current"})})]})})]}),i&&e.jsxs("div",{className:"absolute inset-0 z-[100] bg-[#0c0c0c] p-8 animate-in slide-in-from-bottom duration-300 flex flex-col",children:[e.jsx("button",{onClick:()=>o(null),className:"absolute top-6 right-6 p-2 text-slate-500 hover:text-white transition-colors",children:e.jsx(A,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx(C,{className:"w-6 h-6 text-amber-500"}),e.jsx("h5",{className:"text-white font-black uppercase text-xs tracking-[0.2em]",children:"Detalhes da Inconsistência"})]}),e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs("div",{className:"p-5 rounded-2xl bg-white/[0.03] border border-white/5",children:[e.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-3",children:"Descrição da IA"}),e.jsx("p",{className:"text-sm text-white leading-relaxed font-medium",children:i.alert})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-amber-500/5 border border-amber-500/10",children:[e.jsx("p",{className:"text-amber-500/60 text-[8px] font-black uppercase tracking-widest mb-1",children:"Impacto Fiscal"}),e.jsx("p",{className:"text-xs text-white font-bold",children:"Risco de Multa AGT"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-cyan-500/5 border border-cyan-500/10",children:[e.jsx("p",{className:"text-cyan-500/60 text-[8px] font-black uppercase tracking-widest mb-1",children:"Recomendação"}),e.jsx("p",{className:"text-xs text-white font-bold",children:"Revisar Documento"})]})]})]}),e.jsx("button",{className:"w-full py-4 rounded-xl bg-cyan-500 text-black font-black text-[10px] uppercase tracking-widest",children:"Corrigir na Origem"})]})]})},p=({title:t,value:l,subValue:r,icon:d,color:a,trend:i,loading:o})=>e.jsxs("div",{className:"bg-[#080808] border border-white/[0.03] rounded-[32px] p-8 relative overflow-hidden group hover:border-white/10 transition-all shadow-2xl",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-${a}-500/5 blur-[50px] rounded-full -translate-y-1/2 translate-x-1/2`}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:`p-4 rounded-2xl bg-${a}-500/10 text-${a}-400 border border-${a}-500/20`,children:e.jsx(d,{className:"w-6 h-6"})}),i&&e.jsxs("div",{className:`flex items-center gap-1 px-3 py-1.5 rounded-full text-[10px] font-black uppercase tracking-wider ${i>0?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"}`,children:[i>0?e.jsx(V,{className:"w-3 h-3"}):e.jsx(W,{className:"w-3 h-3"}),Math.abs(i),"%"]})]}),o?e.jsx("div",{className:"h-10 w-48 bg-white/5 animate-pulse rounded-xl mb-3"}):e.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter mb-1.5",children:l}),e.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.25em]",children:t}),r&&e.jsxs("p",{className:"text-[11px] text-slate-400 mt-3 font-medium flex items-center gap-2 opacity-70 group-hover:opacity-100 transition-opacity",children:[e.jsx(K,{className:"w-3 h-3 text-cyan-400"}),r]})]})]}),ne=()=>{const{selectedCompany:t,isLoadingData:l}=v(),[r,d]=n.useState(!0),[a,i]=n.useState(null),[o,c]=n.useState("30D"),x=async()=>{if(!l){d(!0);try{const s=t==="ALL"?"ALL":t==null?void 0:t.id,b=await w.getFaturixStats(s);i(b)}catch(s){console.error("Failed to load fiscal stats:",s)}finally{d(!1)}}};n.useEffect(()=>{x()},[t,l]);const h=n.useMemo(()=>a!=null&&a.chart_data?a.chart_data.map(s=>({name:s.date,entradas:parseInt(s.count)*25e3,saidas:parseInt(s.count)*12e3})):[],[a]);return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-700 pb-20",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-slate-600 uppercase tracking-[0.2em] mb-2",children:[e.jsx("span",{children:"Análise Executiva"}),e.jsx(T,{className:"w-3 h-3"}),e.jsx("span",{className:"text-cyan-500",children:"Fluxo Transacional"})]})}),e.jsx("div",{className:"flex items-center gap-4 bg-[#080808] border border-white/[0.03] p-1.5 rounded-2xl shadow-xl",children:["7D","30D","90D","1Y"].map(s=>e.jsx("button",{onClick:()=>c(s),className:`px-5 py-2.5 rounded-xl text-[10px] font-black tracking-widest transition-all ${o===s?"bg-white/10 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:s},s))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(p,{title:"Total Faturamento",value:m((a==null?void 0:a.total_sales)||0),subValue:"Volume bruto processado",icon:R,color:"emerald",loading:r,trend:12.5}),e.jsx(p,{title:"Custos & Despesas",value:m((a==null?void 0:a.total_expenses)||0),subValue:"Encargos operacionais",icon:D,color:"rose",loading:r,trend:-5.2}),e.jsx(p,{title:"IVA Liquidado",value:m((a==null?void 0:a.vat_payable)||0),subValue:"Imposto sobre vendas",icon:I,color:"amber",loading:r}),e.jsx(p,{title:"IVA Dedutível",value:m((a==null?void 0:a.vat_deductible)||0),subValue:"Recuperação tributária",icon:f,color:"cyan",loading:r})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 bg-[#080808] border border-white/[0.03] rounded-[40px] p-10 shadow-2xl overflow-hidden relative group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-cyan-500/20 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-center mb-10",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-black text-2xl tracking-tighter",children:"Dinâmica Transacional de IVA"}),e.jsxs("p",{className:"text-slate-500 text-xs mt-2 flex items-center gap-2 font-medium font-mono uppercase tracking-widest",children:[e.jsx(N,{className:"w-3 h-3 text-cyan-400"}),"Fluxo de Entradas vs Saídas"]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-emerald-400 uppercase tracking-widest px-3 py-1.5 rounded-lg bg-emerald-500/5 border border-emerald-500/10",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"})," Entradas"]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-rose-400 uppercase tracking-widest px-3 py-1.5 rounded-lg bg-rose-500/5 border border-rose-500/10",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-rose-500"})," Saídas"]})]})]}),e.jsx("div",{className:"h-[400px] w-full",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(P,{data:h,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gradEntradas",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"gradSaidas",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]})]}),e.jsx(F,{strokeDasharray:"5 5",vertical:!1,stroke:"#ffffff03"}),e.jsx($,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#475569",fontSize:9,fontWeight:800,fontFamily:"monospace"},dy:15}),e.jsx(O,{axisLine:!1,tickLine:!1,tick:{fill:"#475569",fontSize:9,fontWeight:800,fontFamily:"monospace"},tickFormatter:s=>y(s)}),e.jsx(_,{cursor:{stroke:"rgba(255,255,255,0.1)",strokeWidth:1},contentStyle:{backgroundColor:"#0c0c0c",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"24px",boxShadow:"0 25px 50px rgba(0,0,0,0.8)",padding:"16px"},itemStyle:{fontSize:"12px",fontWeight:"bold"},formatter:s=>[m(s),""]}),e.jsx(u,{type:"monotone",dataKey:"entradas",stroke:"#10b981",strokeWidth:4,fillOpacity:1,fill:"url(#gradEntradas)",animationDuration:2e3}),e.jsx(u,{type:"monotone",dataKey:"saidas",stroke:"#ef4444",strokeWidth:3,fillOpacity:1,fill:"url(#gradSaidas)",animationDuration:2500})]})})})]}),e.jsx("div",{className:"lg:col-span-4 h-full",children:e.jsx(G,{risks:(a==null?void 0:a.top_risks)||[],loading:r,onViewDetails:s=>console.log("Viewing all risks:",s)})})]}),e.jsxs("div",{className:"fixed inset-0 pointer-events-none z-[-1] overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/4 -right-1/4 w-[700px] h-[700px] bg-cyan-500/5 rounded-full blur-[140px] animate-pulse"}),e.jsx("div",{className:"absolute bottom-1/4 -left-1/4 w-[700px] h-[700px] bg-emerald-500/5 rounded-full blur-[140px] animate-pulse",style:{animationDelay:"3s"}})]})]})};export{ne as default};
